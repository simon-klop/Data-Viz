<!DOCTYPE html>
<html lang="fr">
<head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
  
<h1>start</h1>

<script>
  
const data = d3.csv("https://gist.githubusercontent.com/curran/a08a1080b88344b0c8a7/raw/0e7a9b0a5d22642a06d3d5b9bcbad9890c8ee534/iris.csv", 
              d => {
    d.sepal_length = +d.sepal_length
    d.sepal_width = +d.sepal_width
    return d
})
    
  console.log("test")
      
   
const scatterplot = (dataset) => {

  const l = [...new Set(data.map(d => d.species))];
  
  // https://observablehq.com/@d3/chart-template
  const margin = ({top: 30, right: 100, bottom: 40, left: 50})
  
  const w = 700
  const h = 400

    const svg = d3.create("svg").attr("height", h).attr("width", w)

  const x = d3.scaleLinear().domain(d3.extent(dataset, d => d.sepal_length)).range([margin.left, w - margin.left - margin.right])
  const y = d3.scaleLinear().domain(d3.extent(dataset, d => d.sepal_width)).range([h-margin.bottom, margin.top])
  const c = d3.scaleOrdinal().domain(new Set(dataset.map(d => d.species))).range(["red", "green", "blue"])
  const s = d3.scaleOrdinal().domain(new Set(dataset.map(d => d.species))).range([d3.symbolTriangle, d3.symbolDiamond, d3.symbolCircle])
  
   // svg.selectAll("circle").data(dataset).enter()
     //.append("circle")
     //.attr("cx", d => x(d.sepal_length))
     //.attr("cy", d => y(d.sepal_width))
     //.attr("r", d => 3)
     //.style("fill", d => c(d.species))

    svg.selectAll("shapes").data(dataset).enter()
      .append("path")
      .attr("transform", d => `translate(${x(d.sepal_length)},${y(d.sepal_width)})`)
      .attr("fill", d => c(d.species))
      .attr("d", d3.symbol().type(d => s(d.species)).size(50));
    


const xAxis = g => g
    .attr("transform", `translate(0,${h - margin.bottom})`)
    .call(d3.axisBottom(x))

const yAxis = g => g
    .attr("transform", `translate(${margin.left},0)`)
    .call(d3.axisLeft(y))

  svg.append("g")
      .call(xAxis);

  svg.append("g")
      .call(yAxis);

    svg.selectAll("rect").data(c.domain()).enter()   
      .append("path")
      .attr("transform", (d, i) => `translate(${w - margin.right},${i * 20 +8})`)
      .attr("fill", d => c(d))
      .attr("d", d3.symbol().type(d => s(d)).size(50));
  


     svg.append("g").selectAll("text").data(l).enter()
      .append("text")
      .attr("x", d => w - margin.right + 10)
      .attr("y", (d, i) => i * 20+10)   
      .text(d => d)


        // Title
       svg.append('text')
        .attr('x', w/2 -30)
        .attr('y', 20)
        .attr('text-anchor', 'middle')
        .style('font-family', 'Helvetica')
        .style('font-size', 20)
        .text("Existance d'une fleur par longueur et largeur de sépale");
  
        // X label
        svg.append('text')
        .attr('x', w/2 - 30)
        .attr('y', h - margin.bottom +30)
        .attr('text-anchor', 'middle')
        .style('font-family', 'Helvetica')
        .style('font-size', 12)
        .text('Sepal Length');
        
        // Y label
        svg.append('text')
        .attr('text-anchor', 'middle')
        .attr('transform', 'translate(20,' + h/2 + ')rotate(-90)')
        .style('font-family', 'Helvetica')
        .style('font-size', 12)
        .text("Sepal Width");
  
    return svg.node()
}
})
  
    scatterplot(data)
</script>
</body>
</html>
